(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9289],{46643:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools",function(){return n(30106)}])},99845:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});class s{static toParams(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t+="".concat(n,"=").concat(e[n],"&"));return t.substring(0,t.length-1)}static toFormData(e){let t=new FormData;for(let n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);return t}}},55865:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(73669),i=n(99845);class r{request(e,t,n,i){let r={...this.config,url:e,method:t,data:n,headers:i},l=s.Z.create();return l.interceptors.response.use(this.responseInterceptor,this.errorInterceptor),l.request(r)}get(e,t){return this.request("".concat(e,"?").concat(i.Z.toParams(t)),"get")}post(e,t,n){return this.request(e,"post",t,n)}responseInterceptor(e){switch(e.status){case 200:case 201:return e.data;default:return console.log(e),Promise.reject(e)}}errorInterceptor(e){let t={message:"服务器错误",...e.response.data};return Promise.reject(t)}constructor(e){this.config={},this.config.baseURL="https://web-evo-server.bulv.life/",e&&(this.config.baseURL=e)}}},29179:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var s=n(11527),i=n(8583),r=n.n(i);function l(e){let t="WebEvolution";return(0,s.jsxs)(r(),{children:[(0,s.jsx)("title",{children:e.title||t}),(0,s.jsx)("meta",{name:"description",content:e.description||t+" 是一个帮助web开发者成长的社区。我们以技术文章为核心的产品形态，为开发者提供纯粹、高质的技术文章。"}),(0,s.jsx)("meta",{name:"viewport",content:"initial-scale=1, width=device-width, maximum-scale=1.0, user-scalable=0, viewport-fit=cover"}),(0,s.jsx)("meta",{name:"baidu-site-verification",content:"code-yx2HQhygQo"}),(0,s.jsx)("meta",{name:"msvalidate.01",content:"AB78A0C987D3AEA34B969889512FF33E"}),(0,s.jsx)("meta",{name:"google-site-verification",content:"4rS5gjy4-tFOdJO4HvDg0_E4QNcB1D1YeZo29iS4hIY"}),(0,s.jsx)("meta",{name:"baidu_union_verify",content:"50312ad0c63983b3fe6c2e2a6e10c386"})]})}n(50959)},30106:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var s=n(11527),i=n(50959),r=n(53743),l=n(62833),a=n(50584),o=n(52550),c=n(76306),x=n(19825),d=n(26241),h=n(57775),u=n(19098),f=n(60055),p=n.n(f),m=e=>{let{onChange:t}=e,n=null;return(0,s.jsxs)("div",{className:p().uploader,children:[(0,s.jsx)(c.Z,{onClick:()=>{n&&n.click()},variant:"outlined",children:"选择文件"}),(0,s.jsx)("input",{type:"file",ref:e=>n=e,multiple:!0,onChange:()=>{if(console.log(null==n?void 0:n.files),null==n?void 0:n.files){let e=[];for(let t in n.files)if(n.files.hasOwnProperty(t)){let s=n.files[t],i=URL.createObjectURL(s);e.push({file:s,path:i})}console.log(e),t(e)}}})]})};class j{static toBase64(e){return new Promise((t,n)=>{let s=new FileReader;s.readAsDataURL(e),s.onload=()=>{t(s.result)},s.onerror=e=>{n(e)}})}}var g=n(55865),Z=n(34210),v=n.n(Z),w=n(98777),y=n.n(w),b=n(46576),k=n(29179);n(54574),n(89943),n(44819),n(17290),n(56703),n(46547),n(71078);var _=n(47407),E=n(75492),C=n(12400),P=n(9694),D=n(73102);n(19538),n(24746);var F=n(83111),I=n(59928),L=n(41531),R=n(67956),S=n(93448),A=n(35975),N=e=>{let{children:t,onRun:n,running:l,runText:o}=e,[c,x]=(0,i.useState)([]);(0,i.useEffect)(()=>{x([{title:"图像处理",icon:(0,s.jsx)(F.Z,{}),href:"/tools/image",open:!0,children:[{title:"图像清晰度增强",icon:(0,s.jsx)(D.Z,{}),href:"/tools/image"}]}])},[]);let d=[(0,s.jsx)(_.Z,{underline:"none",color:"inherit",href:"/",children:"WebEvolution"},"1"),(0,s.jsx)(_.Z,{underline:"none",color:"inherit",href:"/tools",children:"工具"},"2"),(0,s.jsx)(a.Z,{color:"text.primary",children:"图像清晰度增强"},"3")];return(0,s.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",height:"calc(100vh - 64px)"},children:[(0,s.jsx)(r.Z,{sx:{height:"40px",background:"#f2f2f2",display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 60px"},children:(0,s.jsx)(E.Z,{title:o,placement:"bottom",children:(0,s.jsx)(A.Z,{variant:"contained",size:"small",loading:l,loadingPosition:"start",color:"primary",startIcon:(0,s.jsx)(S.Z,{}),onClick:n,children:"Run"})})}),(0,s.jsxs)(r.Z,{sx:{flex:1,display:"flex",height:"calc(100% - 70px)"},children:[(0,s.jsx)(r.Z,{sx:{width:"40px",background:"#f2f2f2",margin:"1px 0"},children:(0,s.jsx)(E.Z,{placement:"right",title:"图像清晰度增强",children:(0,s.jsx)(C.Z,{children:(0,s.jsx)(L.Z,{})})})}),(0,s.jsx)(r.Z,{sx:{flex:1,height:"100%"},children:t}),(0,s.jsx)(r.Z,{sx:{width:"40px",background:"#f2f2f2",margin:"1px 0"},children:(0,s.jsx)(E.Z,{placement:"left",title:"通知",children:(0,s.jsx)(C.Z,{children:(0,s.jsx)(R.Z,{})})})})]}),(0,s.jsx)(r.Z,{sx:{height:"30px",background:"#f2f2f2",display:"flex",alignItems:"center",padding:"0 10px"},children:(0,s.jsx)(P.Z,{separator:(0,s.jsx)(I.Z,{fontSize:"small"}),children:d})})]})},O=n(45409),U=n(99845);class Y{static toFile(e,t){var n;let s=e.split(",");if(0===s.length)throw Error("base64转file失败");let i=null===(n=s[0].match(/:(.*?);/))||void 0===n?void 0:n[1],r=atob(s[1]),l=r.length,a=new Uint8Array(l);for(;l--;)a[l]=r.charCodeAt(l);return new File([a],t,{type:i})}}let z=()=>{let{enqueueSnackbar:e}=(0,b.Ds)(),[t,n]=(0,i.useState)([]),[f,p]=(0,i.useState)([]),Z=async e=>{let t=new g.Z("https://web-evo-server.bulv.life/"),n=await t.get("/ali/oss/policy",{}),{dir:s}=n;s="enhance-result";let i=U.Z.toFormData({key:s.length?"".concat(s,"/").concat(e[0].name):e[0].name,...n,file:e[0]});await t.post(n.host,i,{"Content-Type":"multipart/form-data"})},[w,_]=(0,i.useState)(3),[E,C]=(0,i.useState)(!1),P=async()=>{C(!0);try{if(!t.length)return e("请选择图片",{variant:"error"});let n=await Promise.all(t.map(e=>{let{file:t}=e;return j.toBase64(t)})),s=n.map(e=>e.split(",")[1]),i=s.map(e=>new g.Z("https://web-evo-server.bulv.life/").post("/images/enhance",{ImageBase64:e})),r=await Promise.all(i),l=n.map(e=>e.split(",")[0]);p(r.map((e,t)=>{let{EnhancedImage:n}=e;return"".concat(l[t],",").concat(n)})),e("图像处理完成",{variant:"success"});let a=n.map((e,n)=>Y.toFile(e,t[n].file.name));console.log(a),await Z(a)}catch(t){e(t.message,{variant:"error"})}C(!1)};return(0,s.jsxs)(N,{onRun:P,running:E,runText:"开始增强图片",children:[(0,s.jsx)(k.Z,{title:"工具 - WebEvolution",description:"对低质图片进行去雾,无损放大,对比度增强等多种处理,优化重建高清图像.可用于提升相册图像质量,提升视频监控质量等."}),(0,s.jsxs)(r.Z,{sx:{flex:1,background:"#eee",height:"100%",display:"flex",flexDirection:"column"},children:[(0,s.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,s.jsxs)(r.Z,{sx:{width:200,display:{xs:"none",sm:"flex"},alignItems:"center"},children:[(0,s.jsx)(a.Z,{sx:{whiteSpace:"nowrap"},children:"列:"}),(0,s.jsx)(o.ZP,{defaultValue:3,step:1,min:1,max:8,getAriaLabel:e=>"".concat(e),marks:!0,sx:{marginLeft:"12px"},onChangeCommitted:(e,t)=>_(Number(t))})]}),(0,s.jsx)(r.Z,{sx:{flex:1}}),(0,s.jsx)(m,{onChange:e=>n(e)}),(0,s.jsx)(c.Z,{sx:{color:"#fff",marginLeft:"10px"},variant:"contained",startIcon:(0,s.jsx)(O.Z,{}),onClick:()=>{let n=new(v()),s=t.map(e=>{let{file:t}=e;return t.name}),i=f.map(e=>e.split(",")[1]);i.forEach((e,t)=>{n.file(s[t],e,{base64:!0})}),n.generateAsync({type:"blob"}).then(t=>{let n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="图像清晰度增强包 ".concat(y()().format("YYYYMMDDHHmmss"),".zip"),n.click(),e("下载完成, 请到下载管理器查看",{variant:"success"})}).catch(e=>{console.log(e)})},disabled:!f.length,children:"一键下载"})]}),(0,s.jsxs)(r.Z,{sx:{display:"flex",width:"100%",height:"calc(100% - 64px)"},children:[(0,s.jsxs)(r.Z,{sx:{flex:1,display:"flex",flexDirection:"column",height:"100%"},children:[(0,s.jsx)(x.Z,{component:"div",children:"源文件"}),(0,s.jsx)(r.Z,{sx:{flex:1,overflowY:"scroll"},children:(0,s.jsx)(d.Z,{variant:"masonry",cols:w,children:t.map((e,t)=>(0,s.jsxs)(h.Z,{children:[(0,s.jsx)(r.Z,{sx:{position:"relative"},children:(0,s.jsx)("img",{src:"".concat(e.path),style:{width:"100%"},loading:"lazy"})}),(0,s.jsx)(u.Z,{subtitle:e.file.name,title:(e.file.size/1024).toFixed()+"kb"})]},t))})})]}),(0,s.jsxs)(r.Z,{sx:{flex:1,display:"flex"},className:"flex-column",children:[(0,s.jsx)(x.Z,{component:"div",children:"增强后"}),(0,s.jsx)(r.Z,{sx:{overflowY:"scroll",flex:1},children:(0,s.jsx)(d.Z,{variant:"masonry",cols:w,children:f.map((e,t)=>(0,s.jsx)(h.Z,{children:(0,s.jsx)(r.Z,{sx:{position:"relative"},children:(0,s.jsx)("img",{src:"".concat(e),style:{width:"100%"},loading:"lazy"})})},t))})})]})]})]})]})};var B=()=>(0,s.jsx)(b.wT,{dense:!0,maxSnack:1,children:(0,s.jsx)(z,{})})},60055:function(e){e.exports={uploader:"uploader_uploader__dEHys"}}},function(e){e.O(0,[4964,3669,539,6730,9774,2888,179],function(){return e(e.s=46643)}),_N_E=e.O()}]);