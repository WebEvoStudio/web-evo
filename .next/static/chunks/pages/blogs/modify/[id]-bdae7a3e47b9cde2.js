(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{51688:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogs/modify/[id]",function(){return n(27966)}])},39894:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});class r{static toParams(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e+="".concat(n,"=").concat(t[n],"&"));return e.substring(0,e.length-1)}static toFormData(t){let e=new FormData;for(let n in t)t.hasOwnProperty(n)&&e.append(n,t[n]);return e}}},10119:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(73669),s=n(39894);class i{request(t,e,n,s){let i={...this.config,url:t,method:e,data:n,headers:s},a=r.Z.create();return a.interceptors.response.use(this.responseInterceptor,this.errorInterceptor),a.request(i)}get(t,e){return this.request("".concat(t,"?").concat(s.Z.toParams(e)),"get")}post(t,e,n){return this.request(t,"post",e,n)}responseInterceptor(t){switch(t.status){case 200:case 201:return t.data;default:return console.log(t),Promise.reject(t)}}errorInterceptor(t){let e={message:"服务器错误",...t.response.data};return Promise.reject(e)}constructor(t){this.config={},this.config.baseURL="https://web-evo-server.bulv.life/",t&&(this.config.baseURL=t)}}},57820:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(11527),s=n(26125),i=n.n(s);function a(t){let e="WebEvolution";return(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:t.title||e}),(0,r.jsx)("meta",{name:"description",content:t.description||e+" 是一个帮助web开发者成长的社区。我们以技术文章为核心的产品形态，为开发者提供纯粹、高质的技术文章。"}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1, width=device-width, maximum-scale=1.0, user-scalable=0, viewport-fit=cover"}),(0,r.jsx)("meta",{name:"baidu-site-verification",content:"code-yx2HQhygQo"}),(0,r.jsx)("meta",{name:"msvalidate.01",content:"AB78A0C987D3AEA34B969889512FF33E"}),(0,r.jsx)("meta",{name:"google-site-verification",content:"4rS5gjy4-tFOdJO4HvDg0_E4QNcB1D1YeZo29iS4hIY"}),(0,r.jsx)("meta",{name:"baidu_union_verify",content:"50312ad0c63983b3fe6c2e2a6e10c386"})]})}n(50959)},61739:function(t,e,n){"use strict";var r=n(11527),s=n(50959),i=n(53072);n(1631);var a=n(11053),o=n(50043),c=n.n(o),l=n(72494),u=n(70009),d=n(35653),f=n(73669),h=n(10119),v=n(39894),m=n(24661),p=n(78795),g=n(91910),w=n(76306);let x=()=>({editorEffect(t){t.editor.getInputField().addEventListener("onpaste",t=>{t.preventDefault()})}});e.Z=t=>{let[e,n]=(0,s.useState)(t.value||""),[o,b]=(0,s.useState)(t.title||""),j=[(0,l.Z)(),(0,u.Z)(),x()],Z=!!t.id,{enqueueSnackbar:_}=(0,m.Ds)(),k=async t=>{let e=[];try{if(t.length>1)throw Error("一次只能上传一张图片");let n=t[0].name;if(-1!==n.indexOf(" "))throw Error("文件名不允许包含空格");let r=new h.Z("https://web-evo-server.bulv.life/"),s=await r.get("/ali/oss/policy",{}),{dir:i}=s,a=v.Z.toFormData({key:i.length?"".concat(i,"/").concat(t[0].name):t[0].name,...s,file:t[0]}),{filepath:o}=await r.post(s.host,a,{"Content-Type":"multipart/form-data"});return e.push({url:o,alt:"",title:""}),e}catch(t){throw _(t.message,{variant:"error"}),new DOMException(t.message)}};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:c().actions,children:[(0,r.jsx)(p.Z,{sx:{flex:1},mr:2,children:(0,r.jsx)(g.Z,{label:"标题",size:"small",fullWidth:!0,value:o,onChange:t=>{let{target:{value:e}}=t;return b(e)}})}),(0,r.jsx)(w.Z,{variant:"outlined",sx:{mr:2},onClick:()=>{d.Z.write(JSON.stringify({title:o,mark_content:e})).then(()=>_("内容已复制到剪贴板",{variant:"success"}))},children:"复制到剪贴板"}),(0,r.jsx)(w.Z,{variant:"outlined",onClick:Z?()=>{let n="".concat("https://web-evo-server.bulv.life/").concat("blogs"),r={_id:t.id,title:o,markContent:e};f.Z.put(n,r).then(()=>_("文章修改成功",{variant:"success"})).catch(t=>_(t.message,{variant:"error"}))}:()=>{let t="".concat("https://web-evo-server.bulv.life/").concat("blogs");f.Z.post(t,{title:o,markContent:e}).then(()=>_("文章发布成功",{variant:"success"})).catch(t=>_(t.message,{variant:"error"}))},children:Z?"保存修改":"发布"})]}),(0,r.jsx)(i.M,{value:e,plugins:j,locale:a,onChange:t=>n(t),uploadImages:k})]})}},27966:function(t,e,n){"use strict";n.r(e);var r=n(11527),s=n(50959),i=n(66912),a=n(73669),o=n(61739),c=n(57820);e.default=()=>{let{id:t}=(0,i.useRouter)().query,[e,n]=(0,s.useState)({title:"",markContent:""}),l=(0,s.useMemo)(()=>e.title?"修改文章 - ".concat(e.title):"加载中...",[e]);return(0,s.useEffect)(()=>{if(t){let e="".concat("https://web-evo-server.bulv.life/").concat("blogs","/").concat(t);a.Z.get(e).then(t=>{let{data:e}=t;n({title:e.title,markContent:e.markContent})})}},[t]),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.Z,{title:l}),""!==e.title?(0,r.jsx)(o.Z,{title:e.title,value:e.markContent,id:null==t?void 0:t.toString()}):""]})}},50043:function(t){t.exports={actions:"editor_actions__cQ2zk"}},66912:function(t,e,n){t.exports=n(50517)}},function(t){t.O(0,[8270,3669,7602,1382,1820,9774,2888,179],function(){return t(t.s=51688)}),_N_E=t.O()}]);