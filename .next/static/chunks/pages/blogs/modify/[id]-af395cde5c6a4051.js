(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{39782:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogs/modify/[id]",function(){return n(77285)}])},6755:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});class r{static toParams(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e+="".concat(n,"=").concat(t[n],"&"));return e.substring(0,e.length-1)}static toFormData(t){let e=new FormData;for(let n in t)t.hasOwnProperty(n)&&e.append(n,t[n]);return e}}},65593:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(94641),s=n(6755);class i{request(t,e,n,s){let i={...this.config,url:t,method:e,data:n,headers:s},a=r.Z.create();return a.interceptors.response.use(this.responseInterceptor,this.errorInterceptor),a.request(i)}get(t,e){return this.request("".concat(t,"?").concat(s.Z.toParams(e)),"get")}post(t,e,n){return this.request(t,"post",e,n)}responseInterceptor(t){switch(t.status){case 200:case 201:return t.data;default:return console.log(t),Promise.reject(t)}}errorInterceptor(t){let e={message:"服务器错误",...t.response.data};return Promise.reject(e)}constructor(t){this.config={},this.config.baseURL="https://web-evo.bulv.life/service/",t&&(this.config.baseURL=t)}}},7902:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(11527),s=n(8286),i=n.n(s);function a(t){let e="WebEvolution";return(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:t.title||e}),(0,r.jsx)("meta",{name:"description",content:t.description||e+" 是一个帮助web开发者成长的社区。我们以技术文章为核心的产品形态，为开发者提供纯粹、高质的技术文章。"}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1, width=device-width, maximum-scale=1.0, user-scalable=0, viewport-fit=cover"}),(0,r.jsx)("meta",{name:"baidu-site-verification",content:"code-yx2HQhygQo"}),(0,r.jsx)("meta",{name:"msvalidate.01",content:"AB78A0C987D3AEA34B969889512FF33E"}),(0,r.jsx)("meta",{name:"google-site-verification",content:"4rS5gjy4-tFOdJO4HvDg0_E4QNcB1D1YeZo29iS4hIY"}),(0,r.jsx)("meta",{name:"baidu_union_verify",content:"50312ad0c63983b3fe6c2e2a6e10c386"})]})}n(50959)},77285:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return y}});var r=n(11527),s=n(50959),i=n(57079),a=n(94641),o=n(75783);n(5938);var c=n(11053),l=n(72494),u=n(70009),d=n(35653),h=n(65593),f=n(6755),m=n(47461),v=n(24777),p=n(73923),g=n(50254),x=n(63336),w=n(10150),b=n(37886);let j=()=>({editorEffect(t){t.editor.getInputField().addEventListener("onpaste",t=>{t.preventDefault()})}});var Z=t=>{let[e,n]=(0,s.useState)(t.value||""),[i,Z]=(0,s.useState)(t.title||""),_=[(0,l.Z)(),(0,u.Z)(),j()],y=!!t.id,{enqueueSnackbar:E}=(0,m.Ds)(),k=async t=>{let e=[];try{if(t.length>1)throw Error("一次只能上传一张图片");let n=t[0].name;if(-1!==n.indexOf(" "))throw Error("文件名不允许包含空格");let r=new h.Z("https://web-evo.bulv.life/service/"),s=await r.get("/ali/oss/policy",{}),{dir:i}=s,a=f.Z.toFormData({key:i.length?"".concat(i,"/").concat(t[0].name):t[0].name,...s,file:t[0]}),{filepath:o}=await r.post(s.host,a,{"Content-Type":"multipart/form-data"});return e.push({url:o,alt:"",title:""}),e}catch(t){throw E(t.message,{variant:"error"}),new DOMException(t.message)}};return(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"",children:(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(p.Z,{title:(0,r.jsx)(g.Z,{sx:{flex:1},mr:2,children:(0,r.jsx)(x.Z,{label:"标题",size:"small",fullWidth:!0,value:i,onChange:t=>{let{target:{value:e}}=t;return Z(e)}})}),action:(0,r.jsxs)(g.Z,{sx:{display:"flex",alignItems:"center",mt:"6px",mb:"4px"},children:[(0,r.jsx)(w.Z,{variant:"outlined",sx:{mr:2},onClick:()=>{d.Z.write(JSON.stringify({title:i,mark_content:e})).then(()=>E("内容已复制到剪贴板",{variant:"success"}))},children:"复制到剪贴板"}),(0,r.jsx)(w.Z,{variant:"outlined",onClick:y?()=>{let n="".concat("https://web-evo.bulv.life/service/").concat("blogs"),r={_id:t.id,title:i,markContent:e};a.Z.put(n,r).then(()=>E("文章修改成功",{variant:"success"})).catch(t=>E(t.message,{variant:"error"}))}:()=>{let t="".concat("https://web-evo.bulv.life/service/").concat("blogs");a.Z.post(t,{title:i,markContent:e}).then(()=>E("文章发布成功",{variant:"success"})).catch(t=>E(t.message,{variant:"error"}))},children:y?"保存修改":"发布"})]})}),(0,r.jsx)(b.Z,{children:(0,r.jsx)(o.M,{value:e,plugins:_,locale:c,onChange:t=>n(t),uploadImages:k})})]})})})},_=n(7902),y=()=>{let{id:t}=(0,i.useRouter)().query,[e,n]=(0,s.useState)({title:"",markContent:""}),o=(0,s.useMemo)(()=>e.title?"修改文章 - ".concat(e.title):"加载中...",[e]);return(0,s.useEffect)(()=>{if(t){let e="".concat("https://web-evo.bulv.life/service/").concat("blogs","/").concat(t);a.Z.get(e).then(t=>{let{data:e}=t;n({title:e.title,markContent:e.markContent})})}},[t]),(0,r.jsxs)("div",{children:[(0,r.jsx)(_.Z,{title:o}),""!==e.title?(0,r.jsx)(Z,{title:e.title,value:e.markContent,id:null==t?void 0:t.toString()}):""]})}},5938:function(){}},function(t){t.O(0,[9799,4641,1035,2758,2837,9774,2888,179],function(){return t(t.s=39782)}),_N_E=t.O()}]);